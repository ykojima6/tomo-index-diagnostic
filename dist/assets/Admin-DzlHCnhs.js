import{r,d as j,e as p,j as e,B as d,g as u,f as b,h as y}from"./index-DUnTtpZu.js";import{C as n,a as i,b as x,c as o}from"./Card-Csz7sTIT.js";function w(){const[l,N]=r.useState(j()),[t,h]=r.useState(p(30)),c=async()=>{N(j());try{const s=await u(30);h(s)}catch{h(p(30))}};r.useEffect(()=>{c()},[]);const f=()=>{const s=b(),g=new Blob([s],{type:"application/json"}),m=URL.createObjectURL(g),a=document.createElement("a");a.href=m,a.download=`tomo-responses-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(m)},v=()=>{confirm("本当に全てのデータを削除しますか？この操作は取り消せません。")&&(y(),c())};return e.jsx("main",{className:"container py-8",children:e.jsxs("div",{className:"mx-auto max-w-4xl",children:[e.jsxs("header",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:"管理者パネル"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"回答データの管理と統計の確認"})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2 mb-8",children:[e.jsxs(n,{children:[e.jsx(i,{children:e.jsx(x,{children:"統計データ"})}),e.jsx(o,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:["総回答数: ",l.length,"件"]}),e.jsxs("div",{children:["有効回答数: ",t.count,"件（0点除く）"]}),e.jsxs("div",{children:["直近30件の平均: ",t.average,"点"]}),e.jsxs("div",{children:["直近30件の中央値: ",t.median,"点"]}),e.jsxs("div",{children:["最低点: ",t.min,"点"]}),e.jsxs("div",{children:["最高点: ",t.max,"点"]}),e.jsx("div",{className:"text-xs text-gray-500 mt-2",children:"※統計値は0点（デフォルト回答）を除外して計算"})]})})]}),e.jsxs(n,{children:[e.jsx(i,{children:e.jsx(x,{children:"データ管理"})}),e.jsx(o,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(d,{onClick:c,className:"w-full",children:"データを更新"}),e.jsx(d,{onClick:f,variant:"secondary",className:"w-full",children:"データをエクスポート"}),e.jsx(d,{onClick:v,variant:"danger",className:"w-full",children:"全データを削除"})]})})]})]}),e.jsxs(n,{children:[e.jsx(i,{children:e.jsx(x,{children:"最近の回答履歴"})}),e.jsx(o,{children:e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left p-2",children:"ID"}),e.jsx("th",{className:"text-left p-2",children:"日時"}),e.jsx("th",{className:"text-left p-2",children:"総合スコア"}),e.jsx("th",{className:"text-left p-2",children:"ポジティブ"}),e.jsx("th",{className:"text-left p-2",children:"ネガティブ"})]})}),e.jsx("tbody",{children:l.slice(0,50).map(s=>e.jsxs("tr",{className:"border-b",children:[e.jsxs("td",{className:"p-2 font-mono text-xs",children:[s.id.substring(0,8),"..."]}),e.jsx("td",{className:"p-2",children:new Date(s.timestamp).toLocaleString("ja-JP")}),e.jsx("td",{className:"p-2 font-bold",children:s.totalScore.toFixed(2)}),e.jsxs("td",{className:"p-2 text-green-600",children:["+",s.positiveScore.toFixed(2)]}),e.jsxs("td",{className:"p-2 text-red-600",children:["-",s.negativeScore.toFixed(2)]})]},s.id))})]}),l.length===0&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:"まだ回答データがありません"})]})})]})]})})}export{w as default};
